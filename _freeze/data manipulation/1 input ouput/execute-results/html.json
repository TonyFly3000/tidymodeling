{
  "hash": "a256b3a46e0205b8e281858da095f5c8",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"input & ouput in R\"\n\nauthor: \"Tony Duan\"\n\nexecute:\n  warning: false\n  error: false\nformat:\n  html:\n    toc: true\n    toc-location: right\n    code-fold: show\n    code-tools: true\n    number-sections: true\n    code-block-bg: true\n    code-block-border-left: \"#31BAE9\"\n---\n\nData input and ouput in R\n\n![](images/1_-OQi5hp-uoL_KdIydr4hew.gif){width=\"500\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(openxlsx)\nlibrary(readxl)\n```\n:::\n\n\n# Input\n\n## read CSV\n\n::: {.cell}\n\n```{.r .cell-code}\ndata001=read_csv('data/Book3.csv')\nhead(data001)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 2\n      a b    \n  <dbl> <chr>\n1  1241 rhth \n2 35235 rjyyj\n```\n\n\n:::\n:::\n\nread CSV online\n\n::: {.cell}\n\n```{.r .cell-code}\nurl='https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-02-11/hotels.csv'\ndata001=read_csv(url)\nhead(data001)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 32\n  hotel        is_canceled lead_time arrival_date_year arrival_date_month\n  <chr>              <dbl>     <dbl>             <dbl> <chr>             \n1 Resort Hotel           0       342              2015 July              \n2 Resort Hotel           0       737              2015 July              \n3 Resort Hotel           0         7              2015 July              \n4 Resort Hotel           0        13              2015 July              \n5 Resort Hotel           0        14              2015 July              \n6 Resort Hotel           0        14              2015 July              \n# ℹ 27 more variables: arrival_date_week_number <dbl>,\n#   arrival_date_day_of_month <dbl>, stays_in_weekend_nights <dbl>,\n#   stays_in_week_nights <dbl>, adults <dbl>, children <dbl>, babies <dbl>,\n#   meal <chr>, country <chr>, market_segment <chr>,\n#   distribution_channel <chr>, is_repeated_guest <dbl>,\n#   previous_cancellations <dbl>, previous_bookings_not_canceled <dbl>,\n#   reserved_room_type <chr>, assigned_room_type <chr>, …\n```\n\n\n:::\n:::\n\n## read excel\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(openxlsx)\nlibrary(readxl)\n\ndata001=read_excel('data/Book1.xlsx')\nhead(data001)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 2\n      a b    \n  <dbl> <chr>\n1  1241 rhth \n2 35235 rjyyj\n```\n\n\n:::\n:::\n\n## read parquet\n\nmust install in this way,otherwise will report error.\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"arrow\", repos = c(\"https://apache.r-universe.dev\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(arrow)\narrow_info()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nArrow package version: 17.0.0.1\n\nCapabilities:\n               \nacero      TRUE\ndataset    TRUE\nsubstrait FALSE\nparquet    TRUE\njson       TRUE\ns3         TRUE\ngcs       FALSE\nutf8proc   TRUE\nre2        TRUE\nsnappy     TRUE\ngzip       TRUE\nbrotli    FALSE\nzstd       TRUE\nlz4        TRUE\nlz4_frame  TRUE\nlzo       FALSE\nbz2       FALSE\njemalloc  FALSE\nmimalloc   TRUE\n\nMemory:\n                  \nAllocator mimalloc\nCurrent    0 bytes\nMax        0 bytes\n\nRuntime:\n                        \nSIMD Level          none\nDetected SIMD Level none\n\nBuild:\n                                    \nC++ Library Version           17.0.0\nC++ Compiler              AppleClang\nC++ Compiler Version 14.0.0.14000029\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata001=read_parquet('data/df.parquet')\nhead(data001)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 62\n  FlightDate          Airline Origin Dest  Cancelled Diverted CRSDepTime DepTime\n  <dttm>              <chr>   <chr>  <chr> <lgl>     <lgl>         <int>   <dbl>\n1 2022-04-04 00:00:00 Commut… GJT    DEN   FALSE     FALSE          1133    1123\n2 2022-04-04 00:00:00 Commut… HRL    IAH   FALSE     FALSE           732     728\n3 2022-04-04 00:00:00 Commut… DRO    DEN   FALSE     FALSE          1529    1514\n4 2022-04-04 00:00:00 Commut… IAH    GPT   FALSE     FALSE          1435    1430\n5 2022-04-04 00:00:00 Commut… DRO    DEN   FALSE     FALSE          1135    1135\n6 2022-04-04 00:00:00 Commut… DEN    TUL   FALSE     FALSE           955     952\n# ℹ 54 more variables: DepDelayMinutes <dbl>, DepDelay <dbl>, ArrTime <dbl>,\n#   ArrDelayMinutes <dbl>, AirTime <dbl>, CRSElapsedTime <dbl>,\n#   ActualElapsedTime <dbl>, Distance <dbl>, Year <int>, Quarter <int>,\n#   Month <int>, DayofMonth <int>, DayOfWeek <int>,\n#   Marketing_Airline_Network <chr>,\n#   Operated_or_Branded_Code_Share_Partners <chr>,\n#   DOT_ID_Marketing_Airline <int>, IATA_Code_Marketing_Airline <chr>, …\n```\n\n\n:::\n:::\n\nread parquet zip\n::: {.cell}\n\n```{.r .cell-code}\ndata001=read_parquet('data/df.parquet.gzip')\nhead(data001)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 62\n  FlightDate          Airline Origin Dest  Cancelled Diverted CRSDepTime DepTime\n  <dttm>              <chr>   <chr>  <chr> <lgl>     <lgl>         <int>   <dbl>\n1 2022-04-04 00:00:00 Commut… GJT    DEN   FALSE     FALSE          1133    1123\n2 2022-04-04 00:00:00 Commut… HRL    IAH   FALSE     FALSE           732     728\n3 2022-04-04 00:00:00 Commut… DRO    DEN   FALSE     FALSE          1529    1514\n4 2022-04-04 00:00:00 Commut… IAH    GPT   FALSE     FALSE          1435    1430\n5 2022-04-04 00:00:00 Commut… DRO    DEN   FALSE     FALSE          1135    1135\n6 2022-04-04 00:00:00 Commut… DEN    TUL   FALSE     FALSE           955     952\n# ℹ 54 more variables: DepDelayMinutes <dbl>, DepDelay <dbl>, ArrTime <dbl>,\n#   ArrDelayMinutes <dbl>, AirTime <dbl>, CRSElapsedTime <dbl>,\n#   ActualElapsedTime <dbl>, Distance <dbl>, Year <int>, Quarter <int>,\n#   Month <int>, DayofMonth <int>, DayOfWeek <int>,\n#   Marketing_Airline_Network <chr>,\n#   Operated_or_Branded_Code_Share_Partners <chr>,\n#   DOT_ID_Marketing_Airline <int>, IATA_Code_Marketing_Airline <chr>, …\n```\n\n\n:::\n:::\n\n\n\n## read feather\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(feather)\n\ndata001=read_feather('data/feather_file.feather')\nhead(data001)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 62\n  FlightDate          Airline Origin Dest  Cancelled Diverted CRSDepTime DepTime\n  <dttm>              <chr>   <chr>  <chr> <lgl>     <lgl>         <int>   <dbl>\n1 2022-04-04 00:00:00 Commut… GJT    DEN   FALSE     FALSE          1133    1123\n2 2022-04-04 00:00:00 Commut… HRL    IAH   FALSE     FALSE           732     728\n3 2022-04-04 00:00:00 Commut… DRO    DEN   FALSE     FALSE          1529    1514\n4 2022-04-04 00:00:00 Commut… IAH    GPT   FALSE     FALSE          1435    1430\n5 2022-04-04 00:00:00 Commut… DRO    DEN   FALSE     FALSE          1135    1135\n6 2022-04-04 00:00:00 Commut… DEN    TUL   FALSE     FALSE           955     952\n# ℹ 54 more variables: DepDelayMinutes <dbl>, DepDelay <dbl>, ArrTime <dbl>,\n#   ArrDelayMinutes <dbl>, AirTime <dbl>, CRSElapsedTime <dbl>,\n#   ActualElapsedTime <dbl>, Distance <dbl>, Year <int>, Quarter <int>,\n#   Month <int>, DayofMonth <int>, DayOfWeek <int>,\n#   Marketing_Airline_Network <chr>,\n#   Operated_or_Branded_Code_Share_Partners <chr>,\n#   DOT_ID_Marketing_Airline <int>, IATA_Code_Marketing_Airline <chr>, …\n```\n\n\n:::\n:::\n## read JSON file and convert into data frame\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(jsonlite)\ndata=read_json(\"./data/dataj.json\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata002=(data) %>% as.data.frame()\n```\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(data002)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 1\nColumns: 11\n$ glossary.title                                                     <chr> \"ex…\n$ glossary.GlossDiv.title                                            <chr> \"S\"\n$ glossary.GlossDiv.GlossList.GlossEntry.ID                          <chr> \"SG…\n$ glossary.GlossDiv.GlossList.GlossEntry.SortAs                      <chr> \"SG…\n$ glossary.GlossDiv.GlossList.GlossEntry.GlossTerm                   <chr> \"St…\n$ glossary.GlossDiv.GlossList.GlossEntry.Acronym                     <chr> \"SG…\n$ glossary.GlossDiv.GlossList.GlossEntry.Abbrev                      <chr> \"IS…\n$ glossary.GlossDiv.GlossList.GlossEntry.GlossDef.para               <chr> \"A …\n$ glossary.GlossDiv.GlossList.GlossEntry.GlossDef.GlossSeeAlso..GML. <chr> \"GM…\n$ glossary.GlossDiv.GlossList.GlossEntry.GlossDef.GlossSeeAlso..XML. <chr> \"XM…\n$ glossary.GlossDiv.GlossList.GlossEntry.GlossSee                    <chr> \"ma…\n```\n\n\n:::\n:::\n\n## Getting Data from Images\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tesseract)\n```\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\neng <- tesseract(\"eng\")\ntext001 <- tesseract::ocr(\"640.png\", engine = eng)\n```\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncat(text001)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWOODCASK = @WOODCASKSHOP\nwww.woodcask.shop\nSingapore All prices are in 10ml pours.\nPrice valid date: 22-23/2/2025\n1D Name PRICE/1OML\n\"R1054_—-CARONI21Y01997888R60.4%  ~Sst~CS~=“C~S*‘“s*~*~*~*~*~*~*S~SSC<C*‘;*‘«wRROCO\nR1066A Long Pond 2005 stc<h>e ester 550/700 cambridge 62.5% ¥ 50.00\n\"R1063___ LONG POND 2005 HABITATION VELIER 14 YOEASTER1285.4%62% +¥ ~~ 60.00.\nR1030 CARONI 23 YO 1994-2017 DOUBLE MATURATION GUYANA STOCK 57.18% ¥ 150.00\nR1080 CARONI 15 YO SINGLE CASK#3767 LMDW 2000 -2015 68.4% ¥ 400.00\nR1081 Long Pond Plantation Single Cask 1993 CRV 15 YO The Nectar 70cl 76,8% ¥ 50.00\nR1073 New Yarmouth Jamaica 1994 26 YO Year Old Blackadder 66.8% ¥ 50.00\nR1046 CARONI 17 YO VELIER EXTRA STRONG 110 PROOF ¥ 50.00\nR1070 CARONI 23 YO 1997 SPHERIC SPIRITS 1ST FILL BOURBON BARREL#1143 62% ¥ 70.00\nHw s1005 GLEN GRANT 31yo 1970 2001 70cl 45% SAMAROLI Sherry Cask 1025 ¥ 200.00\nWS1395 Longrow 1987 \"The Last Bottling\" Bottled 2007 45% CASK #116 ¥ 100.00\nws1402 Glen Scotia 1977 Prestonfield House 33 YO LMDW & The Nectar 49.1% ¥ 100.00\nws1304 SPRINGBANK 21 YO SINGLE CASK NEDERLAND OLOROSO SHERRY HOGSHEAD 48% ¥ 150.00\nWS1396 Springbank 1993 Moon Import 35th Anniversary / Lawless 45% ¥ 100.00\nws1391 Springbank 1985 Brae Dean Dtm Sherry Wood Moon Import 50% Barrel 40/1-4 ¥ 200.00\nws1210 CLYNELISH 1990-2022 BOURBON BARREL#3477 LMDW ARTIST12 47.7% ¥ 100.00\nWS1450 TALISKER 12 YO The Golden Spirit - John Walker & Sons 1980S BOT 43% ¥ 100.00\nws1165 GLENURY 21 YO 1980 OMC 50% ¥ 100.00\nws1279 GLEN KEITH 20 YO LMDW ARTIST#3 BOURBON BARREL#120560 1992-2013 60.1% ¥ 60.00\nWS1278 GLENCRAIG 35 YO LMDW ARTIST#3 BOURBON BARREL#4257 1976-2013 43.7% ¥ 100.00\n“WS1240 Blair Athol 1976 Cadenhead's 200 1976-1997478% ~~~ ~+¥ ~~~~-80.00°\nWS1233 BENROMACH 28 YO 1965-1993 CADENHEADS AUTHENTIC COLLECTION 47.6% ¥ 120.00\nws1311 SPRINGBANK 22 YO 1992 THE BOTTLERS REFILL SHERRY HOGSHEAD#227 51.9% ¥ 150.00\nws1449 GLENDRONACH 25 YO 1993 -2019 OLOROSO SHERRY CASK#416 51.2% ¥ 60.00\nws1162 MALALLAN 2002-2022 TWE SPEYMALT CASK#9545 55.5% ¥ 60.00\nWS1375, MACALLAN 12 YO LIC UTIF 935 MILANO 1980S 43% ¥ 100.00\nws1358 MACALLAN 8 YEAR OLD SHERRY WOOD 1970S 75CL 43% ¥ 200.00\nwS1205 MACALLAN 11 YO SMWS 24.57 1988 55.9% ¥ 120.00\nws1200 GLENFARCLAS 29 YO 1970 SHERRYWOOD Cadenhead bot 2000 54% ¥ 150.00\nws1341 GLENROTHES 27 YO 1979-2006 RED WINE CASK FINISHED OMC 50% ¥ 120.00\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nraw_tibble001 <- text001 %>% \n  str_split(pattern = \"\\n\") %>% \n  unlist() %>%\n  tibble(data = .) %>% slice(6:n()) %>% filter(str_length(data) >= 2) %>%  mutate(old=data\n         ,data=data %>%str_replace_all('_','')%>%str_replace_all('—','')%>%str_replace_all(\"'\",'')%>%str_replace_all('\"','')\n         ) %>% separate(\n    data, \n    into = c(\"one\", \"price\"), \n    sep = c(\"¥\")\n    ) %>% mutate(\n    id = str_extract(one, \"^\\\\S+ \")\n    ,name=gsub(\"^\\\\S+ \", \"\",one)\n  )\n\n\nglimpse(raw_tibble001)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 30\nColumns: 5\n$ one   <chr> \"R1054-CARONI21Y01997888R60.4%  ~Sst~CS~=“C~S*‘“s*~*~*~*~*~*~*S~…\n$ price <chr> NA, \" 50.00\", \" ~~ 60.00.\", \" 150.00\", \" 400.00\", \" 50.00\", \" 50…\n$ old   <chr> \"\\\"R1054_—-CARONI21Y01997888R60.4%  ~Sst~CS~=“C~S*‘“s*~*~*~*~*~*…\n$ id    <chr> \"R1054-CARONI21Y01997888R60.4% \", \"R1066A \", \"R1063 \", \"R1030 \",…\n$ name  <chr> \" ~Sst~CS~=“C~S*‘“s*~*~*~*~*~*~*S~SSC<C*‘;*‘«wRROCO\", \"Long Pond…\n```\n\n\n:::\n:::\n\n\n\n\n\n# Output\n\n\n## write csv \n\n::: {.cell}\n\n```{.r .cell-code}\nwrite.csv(data001,'data001 csv output data.csv')\n```\n:::\n\n\n\n## write excel\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(openxlsx)\nlibrary(readxl)\nwrite.xlsx(data001,'data001 excel output data.xlsx')\n```\n:::\n\n\n\n## write parquet\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(arrow)\nwrite_parquet(data001,'data/df.parquet')\n```\n:::\n\n\noutput to zip format\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_parquet(data001,'data/df.parquet.gzip',compression='gzip')  \n```\n:::\n\n\n## write feather\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(feather)\nwrite_feather(data001,'data/feather_file.feather')\n```\n:::\n\n\n\n## write txt\n\n::: {.cell}\n\n```{.r .cell-code}\ntext=tibble('hello world\nits time!')\n\nwrite_delim(text, \"text.txt\")\n```\n:::\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}