{
  "hash": "80a60f5eb714d86409b7aeabbcbafdd2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Data manipulation with tidyverse\"\n\nauthor: \"Tony Duan\"\n\nexecute:\n  warning: false\n  error: false\nformat:\n  html:\n    toc: true\n    toc-location: right\n    code-fold: show\n    code-tools: true\n    number-sections: true\n    code-block-bg: true\n    code-block-border-left: \"#31BAE9\"\n---\n\n\ndplyr is a grammar of data manipulation, providing a consistent set of verbs that help you solve the most common data manipulation challenges.\n\n\n![](images/logo.png){width=\"231\"}\n\n\n## load package\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npackageVersion(\"dplyr\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] '1.1.4'\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(mtcars)\nsmall_mtcars = mtcars %>% select(cyl, mpg,hp) %>% head()\n```\n:::\n\n\n## select column\n\n### get column names\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(small_mtcars)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"cyl\" \"mpg\" \"hp\" \n```\n\n\n:::\n:::\n\n\n### select by name\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmtcars %>% select(cyl, mpg,hp) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                    cyl  mpg  hp\nMazda RX4             6 21.0 110\nMazda RX4 Wag         6 21.0 110\nDatsun 710            4 22.8  93\nHornet 4 Drive        6 21.4 110\nHornet Sportabout     8 18.7 175\nValiant               6 18.1 105\nDuster 360            8 14.3 245\nMerc 240D             4 24.4  62\nMerc 230              4 22.8  95\nMerc 280              6 19.2 123\nMerc 280C             6 17.8 123\nMerc 450SE            8 16.4 180\nMerc 450SL            8 17.3 180\nMerc 450SLC           8 15.2 180\nCadillac Fleetwood    8 10.4 205\nLincoln Continental   8 10.4 215\nChrysler Imperial     8 14.7 230\nFiat 128              4 32.4  66\nHonda Civic           4 30.4  52\nToyota Corolla        4 33.9  65\nToyota Corona         4 21.5  97\nDodge Challenger      8 15.5 150\nAMC Javelin           8 15.2 150\nCamaro Z28            8 13.3 245\nPontiac Firebird      8 19.2 175\nFiat X1-9             4 27.3  66\nPorsche 914-2         4 26.0  91\nLotus Europa          4 30.4 113\nFord Pantera L        8 15.8 264\nFerrari Dino          6 19.7 175\nMaserati Bora         8 15.0 335\nVolvo 142E            4 21.4 109\n```\n\n\n:::\n:::\n\n\n\n\n\n### select columns by name match with 'p'\n\n\n\n### select columns by index\n\n#### select first and 3rd columns\n\n\n#### select first to 3rd columns\n\n\n## drop column\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsmall_mtcars %>% select(-cyl)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                   mpg  hp\nMazda RX4         21.0 110\nMazda RX4 Wag     21.0 110\nDatsun 710        22.8  93\nHornet 4 Drive    21.4 110\nHornet Sportabout 18.7 175\nValiant           18.1 105\n```\n\n\n:::\n:::\n\n\n## Renaming column\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsmall_mtcars %>%rename(new_cyl=cyl)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  new_cyl  mpg  hp\nMazda RX4               6 21.0 110\nMazda RX4 Wag           6 21.0 110\nDatsun 710              4 22.8  93\nHornet 4 Drive          6 21.4 110\nHornet Sportabout       8 18.7 175\nValiant                 6 18.1 105\n```\n\n\n:::\n:::\n\n\n## Create column\n\n### Mutate\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsmall_mtcars %>%mutate(new_cyl=cyl+1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  cyl  mpg  hp new_cyl\nMazda RX4           6 21.0 110       7\nMazda RX4 Wag       6 21.0 110       7\nDatsun 710          4 22.8  93       5\nHornet 4 Drive      6 21.4 110       7\nHornet Sportabout   8 18.7 175       9\nValiant             6 18.1 105       7\n```\n\n\n:::\n:::\n\n\n### Transmute,create column and only keep this column\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsmall_mtcars %>%transmute(new_cyl=cyl+1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  new_cyl\nMazda RX4               7\nMazda RX4 Wag           7\nDatsun 710              5\nHornet 4 Drive          7\nHornet Sportabout       9\nValiant                 7\n```\n\n\n:::\n:::\n\n\n## Filter rows\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsmall_mtcars %>%filter(cyl>5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  cyl  mpg  hp\nMazda RX4           6 21.0 110\nMazda RX4 Wag       6 21.0 110\nHornet 4 Drive      6 21.4 110\nHornet Sportabout   8 18.7 175\nValiant             6 18.1 105\n```\n\n\n:::\n:::\n\n\n### Filters with AND conditions\n\n::: {.cell}\n\n```{.r .cell-code}\nsmall_mtcars %>%filter(cyl>5,mpg>20)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               cyl  mpg  hp\nMazda RX4        6 21.0 110\nMazda RX4 Wag    6 21.0 110\nHornet 4 Drive   6 21.4 110\n```\n\n\n:::\n:::\n\n\n### Filters with OR conditions\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsmall_mtcars %>%filter(cyl>5|mpg>20)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  cyl  mpg  hp\nMazda RX4           6 21.0 110\nMazda RX4 Wag       6 21.0 110\nDatsun 710          4 22.8  93\nHornet 4 Drive      6 21.4 110\nHornet Sportabout   8 18.7 175\nValiant             6 18.1 105\n```\n\n\n:::\n:::\n\n\n\n\n### filter row with index\n\n#### 5th rows\n\n\n\n#### 1 and 5tj rows\n\n\n#### 1 to 5th rows\n\n\n#### get ramdon 5 rows\n\n\n## Append\n\n### append by row\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsmall_mtcars %>% rbind(small_mtcars)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                   cyl  mpg  hp\nMazda RX4            6 21.0 110\nMazda RX4 Wag        6 21.0 110\nDatsun 710           4 22.8  93\nHornet 4 Drive       6 21.4 110\nHornet Sportabout    8 18.7 175\nValiant              6 18.1 105\nMazda RX41           6 21.0 110\nMazda RX4 Wag1       6 21.0 110\nDatsun 7101          4 22.8  93\nHornet 4 Drive1      6 21.4 110\nHornet Sportabout1   8 18.7 175\nValiant1             6 18.1 105\n```\n\n\n:::\n:::\n\n\n\n\n### append by column\n\n::: {.cell}\n\n```{.r .cell-code}\nsmall_mtcars %>% cbind(small_mtcars)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  cyl  mpg  hp cyl  mpg  hp\nMazda RX4           6 21.0 110   6 21.0 110\nMazda RX4 Wag       6 21.0 110   6 21.0 110\nDatsun 710          4 22.8  93   4 22.8  93\nHornet 4 Drive      6 21.4 110   6 21.4 110\nHornet Sportabout   8 18.7 175   8 18.7 175\nValiant             6 18.1 105   6 18.1 105\n```\n\n\n:::\n:::\n\n\n### Dropping NA values\n\n### keep NA values\n\n## group by\n\n### average,min,max,sum\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsmall_mtcars %>%group_by(cyl) %>% summarise(avg_mpg=mean(mpg)\n                                            ,min_mpg=min(mpg)\n                                            ,max_mpg=max(mpg)\n                                            ,sum_mpg=sum(mpg))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 5\n    cyl avg_mpg min_mpg max_mpg sum_mpg\n  <dbl>   <dbl>   <dbl>   <dbl>   <dbl>\n1     4    22.8    22.8    22.8    22.8\n2     6    20.4    18.1    21.4    81.5\n3     8    18.7    18.7    18.7    18.7\n```\n\n\n:::\n:::\n\n\n### count record and count distinct record\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsmall_mtcars %>%group_by(cyl) %>% summarise(n_mpg=n()\n                                            ,distinct_n_mpg=n_distinct(mpg)\n                                            \n                                            )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 3\n    cyl n_mpg distinct_n_mpg\n  <dbl> <int>          <int>\n1     4     1              1\n2     6     4              3\n3     8     1              1\n```\n\n\n:::\n:::\n\n## order rows\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsmall_mtcars %>%arrange(cyl) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  cyl  mpg  hp\nDatsun 710          4 22.8  93\nMazda RX4           6 21.0 110\nMazda RX4 Wag       6 21.0 110\nHornet 4 Drive      6 21.4 110\nValiant             6 18.1 105\nHornet Sportabout   8 18.7 175\n```\n\n\n:::\n:::\n\n\n### Sort in descending order\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsmall_mtcars %>%arrange(desc(cyl) )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  cyl  mpg  hp\nHornet Sportabout   8 18.7 175\nMazda RX4           6 21.0 110\nMazda RX4 Wag       6 21.0 110\nHornet 4 Drive      6 21.4 110\nValiant             6 18.1 105\nDatsun 710          4 22.8  93\n```\n\n\n:::\n:::\n\n### Arrange by multiple variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsmall_mtcars %>%arrange(cyl,mpg)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  cyl  mpg  hp\nDatsun 710          4 22.8  93\nValiant             6 18.1 105\nMazda RX4           6 21.0 110\nMazda RX4 Wag       6 21.0 110\nHornet 4 Drive      6 21.4 110\nHornet Sportabout   8 18.7 175\n```\n\n\n:::\n:::\n\n\n\n## join\n\n### inner_join\n\n\n\n### left join\n\n\n\n### anti join\n\n## Reshape tables\n\n\n### Gather data long(wide to long)\n\n\n### Spread data wide (long to wide)\n\n## string\n\n\n### upper case\n\n\n### lower case\n\n\n\n### match\n\n\n### concatenation\n\n\n### replace\n\n\n\n### extract\n\n\n\n## date\n\n## dataframe to numpy array\n\n\n\n# reference:\n\nhttps://dplyr.tidyverse.org/\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}