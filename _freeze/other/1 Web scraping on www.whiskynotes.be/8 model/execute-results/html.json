{
  "hash": "1e2fb2a913b4a03462dddccdbfef0f0d",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Model\"\nsubtitle: \"with whiskynote.be data\"\nauthor: \"Tony Duan\"\n\nexecute:\n  warning: false\n  error: false\n\nformat:\n  html:\n    toc: true\n    toc-location: right\n    code-fold: show\n    code-tools: true\n    number-sections: true\n    code-block-bg: true\n    code-block-border-left: \"#31BAE9\"\n---\n\n::: {#845af162 .cell execution_count=1}\n``` {.python .cell-code}\nimport os\nos.system('pip3 install openpyxl')\n```\n:::\n\n\n::: {#68064a06 .cell execution_count=2}\n``` {.python .cell-code}\nimport tensorflow as tf\n\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pylab as plt\nimport seaborn as sns\n\nfrom siuba.siu import call\nfrom siuba import _, mutate, filter, group_by, summarize,show_query\nfrom siuba import *\n\nfrom siuba.data import mtcars,penguins\n```\n:::\n\n\n::: {#ddf3d496 .cell execution_count=3}\n``` {.python .cell-code}\nimport os\nos.system('pip3 show tensorflow')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nName: tensorflow\nVersion: 2.16.1\nSummary: TensorFlow is an open source machine learning framework for everyone.\nHome-page: https://www.tensorflow.org/\nAuthor: Google Inc.\nAuthor-email: packages@tensorflow.org\nLicense: Apache 2.0\nLocation: /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages\nRequires: absl-py, astunparse, flatbuffers, gast, google-pasta, grpcio, h5py, keras, libclang, ml-dtypes, numpy, opt-einsum, packaging, protobuf, requests, setuptools, six, tensorboard, termcolor, typing-extensions, wrapt\nRequired-by: \n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=2}\n```\n0\n```\n:::\n:::\n\n\n# read in data\n\n::: {#b1e09e86 .cell execution_count=4}\n``` {.python .cell-code}\nimport pandas as pd\ndata=pd.read_excel('./output/all_page_bottle_list_all.xlsx')\n```\n:::\n\n\n::: {#b0ec72fd .cell execution_count=5}\n``` {.python .cell-code}\ndata.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>bottle_name</th>\n      <th>bottle_review_Nose</th>\n      <th>bottle_review_Mouth</th>\n      <th>bottle_review_Finish</th>\n      <th>all_page_score</th>\n      <th>page_class</th>\n      <th>page_published_date</th>\n      <th>page_title</th>\n      <th>review_url</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Cognac Chollet Lot 1960 ‘Le Bon Vivant’ – Fins...</td>\n      <td>Nose: a rich, fragrant and fruity style. Honey...</td>\n      <td>Mouth: more spices now. Mint and pepper, leadi...</td>\n      <td>Finish: medium to long, more on fruit tea now,...</td>\n      <td>0</td>\n      <td>* Cognac</td>\n      <td>30 November 2020</td>\n      <td>Cognac Lot 1960 / XO / Lot 1906 (Malternative ...</td>\n      <td>https://www.whiskynotes.be/2020/cognac/cognac-...</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Cognac Vallein-Tercinier XO ‘Bûche de Noël’ (4...</td>\n      <td>Nose: a profile that I haven’t seen before in ...</td>\n      <td>Mouth: same thoughts, this is far from the fru...</td>\n      <td>Finish: not too long, still on sweet spices, c...</td>\n      <td>0</td>\n      <td>* Cognac</td>\n      <td>30 November 2020</td>\n      <td>Cognac Lot 1960 / XO / Lot 1906 (Malternative ...</td>\n      <td>https://www.whiskynotes.be/2020/cognac/cognac-...</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Cognac Héritage René Rivière Lot 1906 ‘La Fine...</td>\n      <td>Nose: very soft and restrained, especially in ...</td>\n      <td>Mouth: still fresh, certainly not tired, just ...</td>\n      <td>Finish: not too long, I’m afraid. Still on swe...</td>\n      <td>0</td>\n      <td>* Cognac</td>\n      <td>30 November 2020</td>\n      <td>Cognac Lot 1960 / XO / Lot 1906 (Malternative ...</td>\n      <td>https://www.whiskynotes.be/2020/cognac/cognac-...</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Ledaig 10 yo 2010 (53,2%, The Whisky Jury 2020...</td>\n      <td>Nose: classic Ledaig sharpness at first. Brine...</td>\n      <td>Mouth: aniseed and brine again, then smoked ki...</td>\n      <td>Finish: long, returning to the classic Ledaig ...</td>\n      <td>0</td>\n      <td>Ledaig</td>\n      <td>13 November 2020</td>\n      <td>Ledaig 2010 Oloroso (The Whisky Jury)</td>\n      <td>https://www.whiskynotes.be/2020/ledaig/ledaig-...</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Ledaig 10 yo 2010 (54,1%, The Whisky Jury for ...</td>\n      <td>Nose: right, this is going to be difficult. It...</td>\n      <td>Mouth: despite the higher ABV, this takes a bi...</td>\n      <td>Finish: so similar, really.</td>\n      <td>0</td>\n      <td>Ledaig</td>\n      <td>13 November 2020</td>\n      <td>Ledaig 2010 Oloroso (The Whisky Jury)</td>\n      <td>https://www.whiskynotes.be/2020/ledaig/ledaig-...</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {#5bfbc503 .cell execution_count=6}\n``` {.python .cell-code}\nlist(data)\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```\n['bottle_name',\n 'bottle_review_Nose',\n 'bottle_review_Mouth',\n 'bottle_review_Finish',\n 'all_page_score',\n 'page_class',\n 'page_published_date',\n 'page_title',\n 'review_url']\n```\n:::\n:::\n\n\n::: {#3474582f .cell execution_count=7}\n``` {.python .cell-code}\ndata001=data>> filter(_.all_page_score >0\n                      ,_.all_page_score <100\n                      ,_.bottle_review_Nose !='no comment'\n                      ,_.bottle_review_Mouth !='no comment'\n                      ,_.bottle_review_Finish !='no comment'\n                      ) >> mutate(review=_.bottle_review_Nose+_.bottle_review_Mouth+_.bottle_review_Finish\n                      ,review_flag=if_else(_.all_page_score >=90,1, 0))\n```\n:::\n\n\n::: {#61b47e77 .cell execution_count=8}\n``` {.python .cell-code}\nstr(data001)\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```\n'                                            bottle_name  \\\\\\n7     Caol Ila 8 yo 2011 ‘Wee Brother’ (60,2%, Na Br...   \\n8     Caol Ila 9 yo 2011 ‘Big Brother’ (58%, Na Brài...   \\n9     Williamson (Lp) 2010 (52,2%, The Whisky Jury 2...   \\n10    Williamson (Lp) 2010 (53,1%, The Whisky Jury f...   \\n31                   Ardbeg Supernova\\\\n(60,1%, OB 2010)   \\n...                                                 ...   \\n4916  Brora 30 yo\\\\n(56,6%, OB 2004, 3rd release, 300...   \\n4917  Glen Grant 21 yo (70° proof, Gordon & MacPhail...   \\n4918  Brora 30 yo 1972 (49,7%, Douglas Laing Old & R...   \\n4919  Longmorn 39 yo 1969\\\\n(58,9%, Gordon & MacPhail...   \\n4920  Port Ellen 12 yo (59%, James MacArthur ‘Fine M...   \\n\\n                                     bottle_review_Nose  \\\\\\n7     Nose: sweet but even more sea shore salinity. ...   \\n8     Nose: more bready notes, hints of roasted nuts...   \\n9     Nose: plenty of warm smoky notes with the typi...   \\n10    Nose: very similar, clearly sisters. I’d say t...   \\n31    Nose: it shares a lot of elements with the 200...   \\n...                                                 ...   \\n4916  Nose: goat stables and hay. This farminess is ...   \\n4917  Nose: it’s a typical profile, but one we haven...   \\n4918  Nose: without doubt one of the farmiest noses ...   \\n4919  Nose: where is your dictionary of superlatives...   \\n4920  Nose: a myriad of aromas and a sublime combina...   \\n\\n                                    bottle_review_Mouth  \\\\\\n7     Mouth: fairly hot and robust, but showing the ...   \\n8     Mouth: it exchanged some of the robustness and...   \\n9     Mouth: quite oily and full of character. More ...   \\n10    Mouth: again difficult to set apart. Here as w...   \\n31    Mouth: very earthy and grassy now, with wet ha...   \\n...                                                 ...   \\n4916  Mouth: firmer now but still very oily and crea...   \\n4917  Mouth: fairly savoury, with tobacco stepping f...   \\n4918  Mouth: a peaty, earthy start, which gradually ...   \\n4919  Mouth: rich and powerful. Where to start… Clas...   \\n4920  Mouth: more powerful now, with a good dose of ...   \\n\\n                                   bottle_review_Finish  all_page_score  \\\\\\n7     Finish: long, spicy, with zesty lemon, plenty ...              85   \\n8     Finish: long, on bittersweet ashes, ginger and...              82   \\n9     Finish:\\xa0long, coming back to the drier leather...              88   \\n10    Finish:\\xa0quite long, probably more intensely sm...              87   \\n31    Finish: hot and quite sharp. Liquorice and dry...              85   \\n...                                                 ...             ...   \\n4916  Finish: very long, smoked lemons, tar, crushed...              95   \\n4917  Finish: alright, not huge, mainly a mix of her...              96   \\n4918  Finish: rather endless. Most of the sherry not...              96   \\n4919  Finish: very long, oaky and minty, but with th...              96   \\n4920  Finish: very long, on ashtrays, slightly bitte...              97   \\n\\n                        page_class page_published_date  \\\\\\n7                         Caol Ila       5 August 2020   \\n8                         Caol Ila       5 August 2020   \\n9                        Laphroaig       3 August 2020   \\n10                       Laphroaig       3 August 2020   \\n31                          Ardbeg        27 July 2010   \\n...                            ...                 ...   \\n4916                         Brora       20 April 2018   \\n4917                    Glen Grant       15 April 2014   \\n4918                         Brora      28 August 2015   \\n4919                      Longmorn    6 September 2016   \\n4920  Caol Ila-Macallan-Port Ellen     7 December 2018   \\n\\n                                             page_title  \\\\\\n7          Caol Ila 2011 “The Brothers” (Na Bràithrean)   \\n8          Caol Ila 2011 “The Brothers” (Na Bràithrean)   \\n9                     Williamson 2010 (The Whisky Jury)   \\n10                    Williamson 2010 (The Whisky Jury)   \\n31                      Ardbeg Supernova (2010 edition)   \\n...                                                 ...   \\n4916                          Brora 30 years old (2004)   \\n4917                    Glen Grant 21 Years (70° Proof)   \\n4918           Brora 1972 30yo (DL Old & Rare Platinum)   \\n4919                        Longmorn 1969 (G&M for JIS)   \\n4920  Caol Ila 1968 G&M // Macallan 1954 Rinaldi // ...   \\n\\n                                             review_url  \\\\\\n7     https://www.whiskynotes.be/2020/caol-ila/caol-...   \\n8     https://www.whiskynotes.be/2020/caol-ila/caol-...   \\n9     https://www.whiskynotes.be/2020/laphroaig/will...   \\n10    https://www.whiskynotes.be/2020/laphroaig/will...   \\n31    https://www.whiskynotes.be/2010/ardbeg/ardbeg-...   \\n...                                                 ...   \\n4916  https://www.whiskynotes.be/2018/brora/brora-30...   \\n4917  https://www.whiskynotes.be/2014/glen-grant/gle...   \\n4918  https://www.whiskynotes.be/2015/brora/brora-19...   \\n4919  https://www.whiskynotes.be/2016/longmorn/longm...   \\n4920  https://www.whiskynotes.be/2018/port-ellen/cao...   \\n\\n                                                 review  review_flag  \\n7     Nose: sweet but even more sea shore salinity. ...          0.0  \\n8     Nose: more bready notes, hints of roasted nuts...          0.0  \\n9     Nose: plenty of warm smoky notes with the typi...          0.0  \\n10    Nose: very similar, clearly sisters. I’d say t...          1.0  \\n31    Nose: it shares a lot of elements with the 200...          0.0  \\n...                                                 ...          ...  \\n4916  Nose: goat stables and hay. This farminess is ...          NaN  \\n4917  Nose: it’s a typical profile, but one we haven...          NaN  \\n4918  Nose: without doubt one of the farmiest noses ...          NaN  \\n4919  Nose: where is your dictionary of superlatives...          NaN  \\n4920  Nose: a myriad of aromas and a sublime combina...          NaN  \\n\\n[4655 rows x 11 columns]'\n```\n:::\n:::\n\n\n::: {#3c3b33e7 .cell execution_count=9}\n``` {.python .cell-code}\nreview=data001['review'].to_numpy()\nreview[1:3]\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```\narray(['Nose: more bready notes, hints of roasted nuts and smoked almonds. Some leathery touches. Slightly less peat but the coastal punch is still there. A hint of popcorn, vanilla pastry and chocolate as well. Not even close to a sherry bomb, the influence is fairly light and the original whisky is still recognizable, a good choice.Mouth: it exchanged some of the robustness and heat for chocolate biscuits, ginger, nutmeg and grassy notes. The zesty grapefruit and brine are still there. Just a hint of toffee sweetness. The smoke seems deeper, more earthy and sooty now.Finish: long, on bittersweet ashes, ginger and charred oak.',\n       'Nose: plenty of warm smoky notes with the typical mercurochrome and bandages. Tarry ropes and seaweed. Sweet apples and a hint of vanilla biscuit in the background. Leather saddle, as well as some farmy notes (stables). A subtle whiff of oil paint as well.Mouth: quite oily and full of character. More iodine, seaweed, smoked kippers and brine. It gets rounder with hints of almonds and sesame. Sooty notes with a touch of cough syrup. Brine and tapenade.Finish:\\xa0long, coming back to the drier leathery notes, with liquorice and brine in the very end, as well as some smoldering peat.'],\n      dtype=object)\n```\n:::\n:::\n\n\n::: {#e8ee0a08 .cell execution_count=10}\n``` {.python .cell-code}\nreview_flag=data001[\"review_flag\"].to_numpy()\nreview_flag[1:3]\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```\narray([0., 0.])\n```\n:::\n:::\n\n\n# model\n\n\n\n#\n\n",
    "supporting": [
      "8 model_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}