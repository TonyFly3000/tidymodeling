{
  "hash": "bade4b9939ebd2f0e4b160a8c5cc7a7a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"All page link frist time\"\nsubtitle: \"with whiskyfun.com data\"\nauthor: \"Tony Duan\"\n\nexecute:\n  warning: false\n  error: false\n  eval: false\nformat:\n  html:\n    toc: true\n    toc-location: right\n    code-fold: show\n    code-tools: true\n    number-sections: true\n    code-block-bg: true\n    code-block-border-left: \"#31BAE9\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(rvest)\nlibrary(stringr)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npackageVersion(\"rvest\")\n```\n:::\n\n\n\n# all review page\n\n# first page\n\n::: {.cell}\n\n```{.r .cell-code}\nfirst_url='https://www.whiskyfun.com'\nfirst_page=read_html(first_url)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlast_page <- first_page %>%\n  html_elements(css = \"a.textegrandfoncegras\")%>% html_attr(\"href\")\n```\n:::\n\n\n\n# start from secound page\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npage_list=c()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nurl='https://www.whiskyfun.com/archivemarch24-2-Port-Ellen-Glen-Grant.html'\n\npage=read_html(first_url)\n\nlast_page <- (first_page %>%html_elements(css = \"font:nth-child(1) strong a\")%>%html_attr(\"href\"))[1]\n\nprint(last_page)\npage_list=c(page_list,last_page)\n```\n:::\n\n\n# start to download 500 pages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlast_page='https://www.whiskyfun.com/archivemarch24-2-Port-Ellen-Glen-Grant.html'\npage_list=c()\n\nfor (i in seq(1:500)){\n  print(i)\n  page=read_html(last_page)\n  last_page <- (page %>%html_elements(css = \"font:nth-child(1) strong a\")%>%html_attr(\"href\"))[1]\n  last_page=paste0('https://www.whiskyfun.com/',last_page)\n  print(last_page)\n  page_list=c(page_list,last_page)\n  Sys.sleep(runif(n=1, min=0.1, max=0.8))\n  \n  \n  }\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npage_list_data=page_list %>% tibble()\n```\n:::\n\n\n\n# ouput\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(openxlsx)\nwrite.xlsx(page_list_data, file = \"./output/wf_all_page_review.xlsx.xlsx\")\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}