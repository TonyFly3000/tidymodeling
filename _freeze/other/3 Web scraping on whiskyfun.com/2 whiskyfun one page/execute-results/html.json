{
  "hash": "1d9055415b80ac33e9b0cd866aff6f3d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"on page\"\nsubtitle: \"with whiskyfun.com data\"\nauthor: \"Tony Duan\"\n\nexecute:\n  warning: false\n  error: false\n  eval: false\nformat:\n  html:\n    toc: true\n    toc-location: right\n    code-fold: show\n    code-tools: true\n    number-sections: true\n    code-block-bg: true\n    code-block-border-left: \"#31BAE9\"\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(rvest)\nlibrary(stringr)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npackageVersion(\"rvest\")\n```\n:::\n\n\n# review page\n\n::: {.cell}\n\n```{.r .cell-code}\nreview_url='https://www.whiskyfun.com/archivemarch24-2-Port-Ellen-Glen-Grant.html'\n\n#review_url='https://www.whiskynotes.be/2011/port-ellen/port-ellen-10th-release-1978/'\n```\n:::\n\n\n# read in html\n::: {.cell}\n\n```{.r .cell-code}\nreview_page <- read_html(review_url)\n```\n:::\n\n# bottle_review\n\n::: {.cell}\n\n```{.r .cell-code}\nbottle_review=review_page  %>% html_elements(\"p , .textegrandfoncegras , .textegrandfoncegras .TextenormalNEW , .Textenormal .textenormalgras , .Textenormal .TextenormalNEW , td.TextenormalNEW\") %>% html_text2()\n# remove space element\n\nbottle_review1=bottle_review[bottle_review %>% str_detect('SGP:')] \n\nbottle_review2=bottle_review1[bottle_review1 %>% str_detect('Nose:')] \n\nbottle_review2=bottle_review2%>% str_replace(\"Palate:\", \"Mouth\")%>% str_replace(\"â€“\", \"-\")\n\n\nss=head(bottle_review2)\n```\n:::\n\n\n\n\n# bottle_name\n::: {.cell}\n\n```{.r .cell-code}\nbottle_name=str_extract(bottle_review2, \n regex( \"[^)]+\")\n    )\nbottle_name=paste0(bottle_name,\")\")\nlength(bottle_name)\n```\n:::\n\n\n# bottle_score\n::: {.cell}\n\n```{.r .cell-code}\nres <- str_match(bottle_review2, \"SGP:\\\\s*(.*?)\\\\s*points\")\n\nbottle_score=paste(\"SGP:\",res[,2],\" points\")\n\nlength(bottle_score)\n```\n:::\n\n# bottle__final_score\n::: {.cell}\n\n```{.r .cell-code}\nres <- str_match(bottle_score, \" - \\\\s*(.*?)\\\\s*points\")\n\nbottle_final_score=res[,2]\n\nlength(bottle_final_score)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbottle_score[91]\nbottle_final_score[91]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbottle_score[92]\nbottle_final_score[92]\n```\n:::\n\n# Nose\n\n::: {.cell}\n\n```{.r .cell-code}\nres <- str_match(bottle_review2, \"Nose:\\\\s*(.*?)\\\\s*Mouth\")\n\nbottle_name_nose=paste(\"Nose:\",res[,2])\n\nlength(bottle_name_nose)\n```\n:::\n\n#  Mouth\n::: {.cell}\n\n```{.r .cell-code}\nres <- str_match(bottle_review2, \"Mouth\\\\s*(.*?)\\\\s*Finish:\")\n\nbottle_name_mouth=paste(\"Mouth:\",res[,2])\n\nlength(bottle_name_mouth)\n```\n:::\n\n\n#  Colour\n::: {.cell}\n\n```{.r .cell-code}\nres <- str_match(bottle_review2, \"Colour\\\\s*(.*?)\\\\s*\\\\.\")\n\nbottle_name_colour=paste(\"Colour \",res[,2])\n\nlength(bottle_name_colour)\n```\n:::\n\n\n\n# bottle_name_finish\n::: {.cell}\n\n```{.r .cell-code}\nres <- str_match(bottle_review2, \"Finish:\\\\s*(.*?)\\\\s*Comments:\")\nbottle_name_finish=paste(\"Finish:\",res[,2])\n\nlength(bottle_name_finish)\n```\n:::\n\n# bottle_name_comments\n::: {.cell}\n\n```{.r .cell-code}\nres <- str_match(bottle_review2, \"Comments:\\\\s*(.*?)\\\\s*SGP:\")\nbottle_name_comments=paste(\"Comments:\",res[,2])\n\nlength(bottle_name_comments)\n```\n:::\n\n# combine\n\n::: {.cell}\n\n```{.r .cell-code}\ndata=tibble(bottle_name,bottle_name_nose,bottle_name_mouth,bottle_name_finish,bottle_name_colour,bottle_name_comments,bottle_score,bottle_final_score,review_url)\n\nhead(data)\n```\n:::\n\n\n# output\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(openxlsx)\nwrite.xlsx(data, file = \"./output/whiskyfun one page.xlsx\")\n```\n:::\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}